{"ast":null,"code":"import _slicedToArray from\"/Users/pablogrillo/Desktop/losty-web/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useEffect,useState}from\"react\";import SectionMain from\"../common/components/Section/SectionMain\";import{useAppDispatch}from\"../hooks/storeHook\";import{fetchUser}from\"../features/user/services/user.service\";import{selectUser}from\"../store/features/userSlice\";import{useSelector}from\"react-redux\";import{ReportType}from\"../models/Marker\";import{deleteMarker}from\"../features/explore/services/report.service\";import Button from\"../common/components/Button\";import Modal from\"../common/components/Modal\";import{selectReportState}from\"../store/features/reportSlice\";import CardBoxUser from\"../features/user/components/User\";import CardBox from\"../common/components/Cards\";import ItemCard from\"../features/explore/components/ItemCard\";import{useNavigate}from\"react-router-dom\";import{IoMailUnreadOutline}from\"react-icons/io5\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var ProfilePage=function ProfilePage(){var user=useSelector(selectUser);var dispatch=useAppDispatch();var _useState=useState(false),_useState2=_slicedToArray(_useState,2),showModal=_useState2[0],setShowModal=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),selectedItem=_useState4[0],setSelectedItem=_useState4[1];var reportState=useSelector(selectReportState);var navigate=useNavigate();useEffect(function(){dispatch(fetchUser());},[dispatch]);var openModal=function openModal(id){setShowModal(function(prev){return!prev;});setSelectedItem(id);};var deleteItem=function deleteItem(id){dispatch(deleteMarker(id));if(!reportState.loading){setShowModal(function(prev){return!prev;});dispatch(fetchUser());}};var handleClick=function handleClick(chat,item){navigate(\"/chat/\".concat(chat),{state:{item:item}});};var ProfileItemCard=function ProfileItemCard(_ref){var items=_ref.items,reportType=_ref.reportType;return/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-1 flex-col text-black p-2\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-2xl font-[600] mb-5\",children:reportType===ReportType.FOUND?'Found Items':'Lost Items'}),/*#__PURE__*/_jsx(\"div\",{className:\"flex\",children:items.map(function(item,index){return/*#__PURE__*/_jsx(CardBox,{className:\"mx-2 max-w-[250px]\",footer:/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-row justify-around\",children:[user.chats.length>0&&user.chats.map(function(chat,index){return chat.chatRoom.includes(item._id)&&/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-around cursor-pointer\",onClick:function onClick(){handleClick(chat.chatRoom,item);},children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center m-3 p-1 bg-main rounded-md\",children:[/*#__PURE__*/_jsx(Button,{small:true,icon:IoMailUnreadOutline,color:\"main\"}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-white mx-1\",children:\"New messages!\"},index)]})});}),/*#__PURE__*/_jsx(Button,{className:\"flex-1 p-1 m-3 justify-end\",small:true,label:\"Delete\",color:\"transparent\",onClick:function onClick(){return openModal(item._id);}})]}),children:/*#__PURE__*/_jsx(ItemCard,{marker:item})},index);})})]});};return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(SectionMain,{children:[/*#__PURE__*/_jsx(CardBoxUser,{className:\"mb-6\"}),/*#__PURE__*/_jsx(\"div\",{className:\"text-black text-2xl font-[600] mb-5\",children:\"My Items\"}),user.items.length>0?/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col justify-between px-2\",children:[user.items.filter(function(item){return item.reportType===ReportType.FOUND;}).length>0&&/*#__PURE__*/_jsx(ProfileItemCard,{items:user.items.filter(function(item){return item.reportType===ReportType.FOUND;}),reportType:ReportType.FOUND}),user.items.filter(function(item){return item.reportType===ReportType.LOST;}).length>0&&/*#__PURE__*/_jsx(ProfileItemCard,{items:user.items.filter(function(item){return item.reportType===ReportType.LOST;}),reportType:ReportType.LOST})]}):/*#__PURE__*/_jsx(\"div\",{className:\"text-slate-500 text-l mb-5\",children:\"You don't have any reported items\"})]}),/*#__PURE__*/_jsx(Modal,{onRequestClose:function onRequestClose(){},showModal:showModal,children:/*#__PURE__*/_jsxs(CardBox,{title:\"Are you sure you want to delete this item?\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"m-5 text-black\",children:\"Are you sure you want to delete this item?\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-row justify-around m-3\",children:[/*#__PURE__*/_jsx(Button,{className:\"p-2\",label:\"Delete\",color:\"main\",onClick:function onClick(){return deleteItem(selectedItem);}}),/*#__PURE__*/_jsx(Button,{className:\"p-2\",label:\"Cancel\",color:\"transparent\",onClick:function onClick(){return setShowModal(function(prev){return!prev;});}})]})]})})]});};export default ProfilePage;","map":{"version":3,"names":["useEffect","useState","SectionMain","useAppDispatch","fetchUser","selectUser","useSelector","ReportType","deleteMarker","Button","Modal","selectReportState","CardBoxUser","CardBox","ItemCard","useNavigate","IoMailUnreadOutline","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","ProfilePage","user","dispatch","_useState","_useState2","_slicedToArray","showModal","setShowModal","_useState3","_useState4","selectedItem","setSelectedItem","reportState","navigate","openModal","id","prev","deleteItem","loading","handleClick","chat","item","concat","state","ProfileItemCard","_ref","items","reportType","className","children","FOUND","map","index","footer","chats","length","chatRoom","includes","_id","onClick","small","icon","color","label","marker","filter","LOST","onRequestClose","title"],"sources":["/Users/pablogrillo/Desktop/losty-web/client/src/pages/Profile.tsx"],"sourcesContent":["import { useEffect, useState } from \"react\";\nimport SectionMain from \"../common/components/Section/SectionMain\"\nimport { useAppDispatch } from \"../hooks/storeHook\";\nimport { fetchUser } from \"../features/user/services/user.service\";\nimport { selectUser } from \"../store/features/userSlice\";\nimport { useSelector } from \"react-redux\";\nimport { Marker, ReportType } from \"../models/Marker\";\nimport { deleteMarker } from \"../features/explore/services/report.service\";\nimport Button from \"../common/components/Button\";\nimport Modal from \"../common/components/Modal\";\nimport { selectReportState } from \"../store/features/reportSlice\";\nimport CardBoxUser from \"../features/user/components/User\";\nimport CardBox from \"../common/components/Cards\";\nimport ItemCard from \"../features/explore/components/ItemCard\";\nimport { useNavigate } from \"react-router-dom\";\nimport { IoMailUnreadOutline } from \"react-icons/io5\";\n\nconst ProfilePage = () => {\n    const user = useSelector(selectUser);\n    const dispatch = useAppDispatch();\n    const [showModal, setShowModal] = useState<boolean>(false);\n    const [selectedItem, setSelectedItem] = useState<string | null>(null);\n    const reportState = useSelector(selectReportState);\n    const navigate = useNavigate();\n\n    useEffect(() => {\n        dispatch(fetchUser());\n    }, [dispatch]);\n\n    const openModal = (id: string) => {\n        setShowModal((prev) => !prev);\n        setSelectedItem(id);\n    }\n\n    const deleteItem = (id: string): void => {\n        dispatch(deleteMarker(id));\n\n        if (!reportState.loading) {\n            setShowModal((prev) => !prev);\n            dispatch(fetchUser());\n        }\n    }\n\n    const handleClick = (chat: string, item: Marker) => {\n        navigate(`/chat/${chat}`, { state: { item } });\n    }\n\n    const ProfileItemCard = ({ items, reportType }: { items: Marker[], reportType: ReportType }) => {\n        return <div className=\"flex flex-1 flex-col text-black p-2\">\n            <div className=\"text-2xl font-[600] mb-5\">{reportType === ReportType.FOUND ? 'Found Items' : 'Lost Items'}</div>\n            <div className=\"flex\">\n                {items.map((item, index) => (\n                    <CardBox className=\"mx-2 max-w-[250px]\" key={index} footer={\n                        <div className=\"flex flex-row justify-around\">\n                            {user.chats.length > 0 && (user.chats.map((chat, index) => (\n                                chat.chatRoom.includes(item._id!) &&\n                                (<div className=\"flex justify-around cursor-pointer\" onClick={() => { handleClick(chat.chatRoom, item) }}>\n                                    <div className=\"flex items-center m-3 p-1 bg-main rounded-md\">\n                                        <Button small icon={IoMailUnreadOutline} color=\"main\" />\n                                        <div key={index}\n                                            className=\"text-sm text-white mx-1\">\n                                            New messages!\n                                        </div>\n                                    </div>\n\n                                </div>)\n                            )))}\n                            <Button className=\"flex-1 p-1 m-3 justify-end\" small label='Delete' color='transparent' onClick={() => openModal(item._id!)}></Button>\n                        </div>}>\n                        <ItemCard marker={item} ></ItemCard>\n                    </CardBox>\n                ))}\n            </div>\n        </div>\n    };\n\n    return (\n        <>\n            <SectionMain>\n                <CardBoxUser className=\"mb-6\" />\n                <div className=\"text-black text-2xl font-[600] mb-5\">My Items</div>\n                {user.items.length > 0 ?\n                    <div className=\"flex flex-col justify-between px-2\">\n                        {user.items.filter(item => item.reportType === ReportType.FOUND).length > 0 &&\n                            <ProfileItemCard items={user.items.filter(item => item.reportType === ReportType.FOUND)} reportType={ReportType.FOUND} />}\n                        {user.items.filter(item => item.reportType === ReportType.LOST).length > 0 &&\n                            <ProfileItemCard items={user.items.filter(item => item.reportType === ReportType.LOST)} reportType={ReportType.LOST} />}\n                    </div> :\n                    <div className=\"text-slate-500 text-l mb-5\">You don't have any reported items</div>}\n            </SectionMain>\n            <Modal onRequestClose={() => { }} showModal={showModal}>\n                <CardBox title=\"Are you sure you want to delete this item?\">\n                    <div className=\"m-5 text-black\">Are you sure you want to delete this item?</div>\n                    <div className=\"flex flex-row justify-around m-3\">\n                        <Button className=\"p-2\" label=\"Delete\" color=\"main\" onClick={() => deleteItem(selectedItem!)} />\n                        <Button className=\"p-2\" label=\"Cancel\" color=\"transparent\" onClick={() => setShowModal((prev) => !prev)} />\n                    </div>\n                </CardBox>\n            </Modal>\n        </>\n    );\n}\n\nexport default ProfilePage;"],"mappings":"iIAAA,OAASA,SAAS,CAAEC,QAAQ,KAAQ,OAAO,CAC3C,MAAO,CAAAC,WAAW,KAAM,0CAA0C,CAClE,OAASC,cAAc,KAAQ,oBAAoB,CACnD,OAASC,SAAS,KAAQ,wCAAwC,CAClE,OAASC,UAAU,KAAQ,6BAA6B,CACxD,OAASC,WAAW,KAAQ,aAAa,CACzC,OAAiBC,UAAU,KAAQ,kBAAkB,CACrD,OAASC,YAAY,KAAQ,6CAA6C,CAC1E,MAAO,CAAAC,MAAM,KAAM,6BAA6B,CAChD,MAAO,CAAAC,KAAK,KAAM,4BAA4B,CAC9C,OAASC,iBAAiB,KAAQ,+BAA+B,CACjE,MAAO,CAAAC,WAAW,KAAM,kCAAkC,CAC1D,MAAO,CAAAC,OAAO,KAAM,4BAA4B,CAChD,MAAO,CAAAC,QAAQ,KAAM,yCAAyC,CAC9D,OAASC,WAAW,KAAQ,kBAAkB,CAC9C,OAASC,mBAAmB,KAAQ,iBAAiB,CAAC,OAAAC,GAAA,IAAAC,IAAA,gCAAAC,IAAA,IAAAC,KAAA,gCAAAC,QAAA,IAAAC,SAAA,yBAEtD,GAAM,CAAAC,WAAW,CAAG,QAAd,CAAAA,WAAWA,CAAA,CAAS,CACtB,GAAM,CAAAC,IAAI,CAAGlB,WAAW,CAACD,UAAU,CAAC,CACpC,GAAM,CAAAoB,QAAQ,CAAGtB,cAAc,CAAC,CAAC,CACjC,IAAAuB,SAAA,CAAkCzB,QAAQ,CAAU,KAAK,CAAC,CAAA0B,UAAA,CAAAC,cAAA,CAAAF,SAAA,IAAnDG,SAAS,CAAAF,UAAA,IAAEG,YAAY,CAAAH,UAAA,IAC9B,IAAAI,UAAA,CAAwC9B,QAAQ,CAAgB,IAAI,CAAC,CAAA+B,UAAA,CAAAJ,cAAA,CAAAG,UAAA,IAA9DE,YAAY,CAAAD,UAAA,IAAEE,eAAe,CAAAF,UAAA,IACpC,GAAM,CAAAG,WAAW,CAAG7B,WAAW,CAACK,iBAAiB,CAAC,CAClD,GAAM,CAAAyB,QAAQ,CAAGrB,WAAW,CAAC,CAAC,CAE9Bf,SAAS,CAAC,UAAM,CACZyB,QAAQ,CAACrB,SAAS,CAAC,CAAC,CAAC,CACzB,CAAC,CAAE,CAACqB,QAAQ,CAAC,CAAC,CAEd,GAAM,CAAAY,SAAS,CAAG,QAAZ,CAAAA,SAASA,CAAIC,EAAU,CAAK,CAC9BR,YAAY,CAAC,SAACS,IAAI,QAAK,CAACA,IAAI,GAAC,CAC7BL,eAAe,CAACI,EAAE,CAAC,CACvB,CAAC,CAED,GAAM,CAAAE,UAAU,CAAG,QAAb,CAAAA,UAAUA,CAAIF,EAAU,CAAW,CACrCb,QAAQ,CAACjB,YAAY,CAAC8B,EAAE,CAAC,CAAC,CAE1B,GAAI,CAACH,WAAW,CAACM,OAAO,CAAE,CACtBX,YAAY,CAAC,SAACS,IAAI,QAAK,CAACA,IAAI,GAAC,CAC7Bd,QAAQ,CAACrB,SAAS,CAAC,CAAC,CAAC,CACzB,CACJ,CAAC,CAED,GAAM,CAAAsC,WAAW,CAAG,QAAd,CAAAA,WAAWA,CAAIC,IAAY,CAAEC,IAAY,CAAK,CAChDR,QAAQ,UAAAS,MAAA,CAAUF,IAAI,EAAI,CAAEG,KAAK,CAAE,CAAEF,IAAI,CAAJA,IAAK,CAAE,CAAC,CAAC,CAClD,CAAC,CAED,GAAM,CAAAG,eAAe,CAAG,QAAlB,CAAAA,eAAeA,CAAAC,IAAA,CAA2E,IAArE,CAAAC,KAAK,CAAAD,IAAA,CAALC,KAAK,CAAEC,UAAU,CAAAF,IAAA,CAAVE,UAAU,CACxC,mBAAO9B,KAAA,QAAK+B,SAAS,CAAC,qCAAqC,CAAAC,QAAA,eACvDlC,IAAA,QAAKiC,SAAS,CAAC,0BAA0B,CAAAC,QAAA,CAAEF,UAAU,GAAK3C,UAAU,CAAC8C,KAAK,CAAG,aAAa,CAAG,YAAY,CAAM,CAAC,cAChHnC,IAAA,QAAKiC,SAAS,CAAC,MAAM,CAAAC,QAAA,CAChBH,KAAK,CAACK,GAAG,CAAC,SAACV,IAAI,CAAEW,KAAK,qBACnBrC,IAAA,CAACL,OAAO,EAACsC,SAAS,CAAC,oBAAoB,CAAaK,MAAM,cACtDpC,KAAA,QAAK+B,SAAS,CAAC,8BAA8B,CAAAC,QAAA,EACxC5B,IAAI,CAACiC,KAAK,CAACC,MAAM,CAAG,CAAC,EAAKlC,IAAI,CAACiC,KAAK,CAACH,GAAG,CAAC,SAACX,IAAI,CAAEY,KAAK,QAClD,CAAAZ,IAAI,CAACgB,QAAQ,CAACC,QAAQ,CAAChB,IAAI,CAACiB,GAAI,CAAC,eAChC3C,IAAA,QAAKiC,SAAS,CAAC,oCAAoC,CAACW,OAAO,CAAE,SAAAA,QAAA,CAAM,CAAEpB,WAAW,CAACC,IAAI,CAACgB,QAAQ,CAAEf,IAAI,CAAC,CAAC,CAAE,CAAAQ,QAAA,cACrGhC,KAAA,QAAK+B,SAAS,CAAC,8CAA8C,CAAAC,QAAA,eACzDlC,IAAA,CAACT,MAAM,EAACsD,KAAK,MAACC,IAAI,CAAEhD,mBAAoB,CAACiD,KAAK,CAAC,MAAM,CAAE,CAAC,cACxD/C,IAAA,QACIiC,SAAS,CAAC,yBAAyB,CAAAC,QAAA,CAAC,eAExC,EAHUG,KAGL,CAAC,EACL,CAAC,CAEL,CAAE,EACV,CAAE,cACHrC,IAAA,CAACT,MAAM,EAAC0C,SAAS,CAAC,4BAA4B,CAACY,KAAK,MAACG,KAAK,CAAC,QAAQ,CAACD,KAAK,CAAC,aAAa,CAACH,OAAO,CAAE,SAAAA,QAAA,QAAM,CAAAzB,SAAS,CAACO,IAAI,CAACiB,GAAI,CAAC,EAAC,CAAS,CAAC,EACrI,CAAE,CAAAT,QAAA,cACPlC,IAAA,CAACJ,QAAQ,EAACqD,MAAM,CAAEvB,IAAK,CAAY,CAAC,EAjBKW,KAkBpC,CAAC,EACb,CAAC,CACD,CAAC,EACL,CAAC,CACV,CAAC,CAED,mBACInC,KAAA,CAAAE,SAAA,EAAA8B,QAAA,eACIhC,KAAA,CAAClB,WAAW,EAAAkD,QAAA,eACRlC,IAAA,CAACN,WAAW,EAACuC,SAAS,CAAC,MAAM,CAAE,CAAC,cAChCjC,IAAA,QAAKiC,SAAS,CAAC,qCAAqC,CAAAC,QAAA,CAAC,UAAQ,CAAK,CAAC,CAClE5B,IAAI,CAACyB,KAAK,CAACS,MAAM,CAAG,CAAC,cAClBtC,KAAA,QAAK+B,SAAS,CAAC,oCAAoC,CAAAC,QAAA,EAC9C5B,IAAI,CAACyB,KAAK,CAACmB,MAAM,CAAC,SAAAxB,IAAI,QAAI,CAAAA,IAAI,CAACM,UAAU,GAAK3C,UAAU,CAAC8C,KAAK,GAAC,CAACK,MAAM,CAAG,CAAC,eACvExC,IAAA,CAAC6B,eAAe,EAACE,KAAK,CAAEzB,IAAI,CAACyB,KAAK,CAACmB,MAAM,CAAC,SAAAxB,IAAI,QAAI,CAAAA,IAAI,CAACM,UAAU,GAAK3C,UAAU,CAAC8C,KAAK,GAAE,CAACH,UAAU,CAAE3C,UAAU,CAAC8C,KAAM,CAAE,CAAC,CAC5H7B,IAAI,CAACyB,KAAK,CAACmB,MAAM,CAAC,SAAAxB,IAAI,QAAI,CAAAA,IAAI,CAACM,UAAU,GAAK3C,UAAU,CAAC8D,IAAI,GAAC,CAACX,MAAM,CAAG,CAAC,eACtExC,IAAA,CAAC6B,eAAe,EAACE,KAAK,CAAEzB,IAAI,CAACyB,KAAK,CAACmB,MAAM,CAAC,SAAAxB,IAAI,QAAI,CAAAA,IAAI,CAACM,UAAU,GAAK3C,UAAU,CAAC8D,IAAI,GAAE,CAACnB,UAAU,CAAE3C,UAAU,CAAC8D,IAAK,CAAE,CAAC,EAC1H,CAAC,cACNnD,IAAA,QAAKiC,SAAS,CAAC,4BAA4B,CAAAC,QAAA,CAAC,mCAAiC,CAAK,CAAC,EAC9E,CAAC,cACdlC,IAAA,CAACR,KAAK,EAAC4D,cAAc,CAAE,SAAAA,eAAA,CAAM,CAAE,CAAE,CAACzC,SAAS,CAAEA,SAAU,CAAAuB,QAAA,cACnDhC,KAAA,CAACP,OAAO,EAAC0D,KAAK,CAAC,4CAA4C,CAAAnB,QAAA,eACvDlC,IAAA,QAAKiC,SAAS,CAAC,gBAAgB,CAAAC,QAAA,CAAC,4CAA0C,CAAK,CAAC,cAChFhC,KAAA,QAAK+B,SAAS,CAAC,kCAAkC,CAAAC,QAAA,eAC7ClC,IAAA,CAACT,MAAM,EAAC0C,SAAS,CAAC,KAAK,CAACe,KAAK,CAAC,QAAQ,CAACD,KAAK,CAAC,MAAM,CAACH,OAAO,CAAE,SAAAA,QAAA,QAAM,CAAAtB,UAAU,CAACP,YAAa,CAAC,EAAC,CAAE,CAAC,cAChGf,IAAA,CAACT,MAAM,EAAC0C,SAAS,CAAC,KAAK,CAACe,KAAK,CAAC,QAAQ,CAACD,KAAK,CAAC,aAAa,CAACH,OAAO,CAAE,SAAAA,QAAA,QAAM,CAAAhC,YAAY,CAAC,SAACS,IAAI,QAAK,CAACA,IAAI,GAAC,EAAC,CAAE,CAAC,EAC1G,CAAC,EACD,CAAC,CACP,CAAC,EACV,CAAC,CAEX,CAAC,CAED,cAAe,CAAAhB,WAAW"},"metadata":{},"sourceType":"module","externalDependencies":[]}